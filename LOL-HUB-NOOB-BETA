-- 創建驗證UI的函數
local function createAuthUI()
    local player = game.Players.LocalPlayer
    local playerGui = player:WaitForChild("PlayerGui")
    
    -- 創建屏幕GUI
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AuthGUI"
    screenGui.Parent = playerGui
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.ResetOnSpawn = false
    
    -- 創建主框架（可拖拽）
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 400, 0, 200)
    mainFrame.Position = UDim2.new(0.5, -200, 0.5, -100)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true
    mainFrame.Parent = screenGui
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 8)
    UICorner.Parent = mainFrame
    
    -- 創建標題欄
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, 40)
    titleBar.Position = UDim2.new(0, 0, 0, 0)
    titleBar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    titleBar.BorderSizePixel = 0
    titleBar.Parent = mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 8)
    titleCorner.Parent = titleBar
    
    -- 標題文字
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, 0, 1, 0)
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "LOL漢化hub - 驗證"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextScaled = true
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Parent = titleBar
    
    -- 創建輸入框
    local textBox = Instance.new("TextBox")
    textBox.Size = UDim2.new(0.8, 0, 0, 40)
    textBox.Position = UDim2.new(0.1, 0, 0.3, 0)
    textBox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    textBox.PlaceholderText = "請輸入密鑰"
    textBox.Text = ""
    textBox.TextScaled = true
    textBox.ClearTextOnFocus = false
    textBox.Parent = mainFrame
    
    local textBoxCorner = Instance.new("UICorner")
    textBoxCorner.CornerRadius = UDim.new(0, 6)
    textBoxCorner.Parent = textBox
    
    local textBoxPadding = Instance.new("UIPadding")
    textBoxPadding.PaddingLeft = UDim.new(0, 10)
    textBoxPadding.PaddingRight = UDim.new(0, 10)
    textBoxPadding.Parent = textBox
    
    -- 創建驗證按鈕
    local verifyButton = Instance.new("TextButton")
    verifyButton.Size = UDim2.new(0.8, 0, 0, 40)
    verifyButton.Position = UDim2.new(0.1, 0, 0.65, 0)
    verifyButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
    verifyButton.Text = "驗證"
    verifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    verifyButton.TextScaled = true
    verifyButton.Parent = mainFrame
    
    local verifyButtonCorner = Instance.new("UICorner")
    verifyButtonCorner.CornerRadius = UDim.new(0, 6)
    verifyButtonCorner.Parent = verifyButton
    
    -- 等待驗證完成
    local done = false
    
    -- 按鈕點擊事件
    verifyButton.MouseButton1Click:Connect(function()
        if textBox.Text == "LOL" then
            done = true
            screenGui:Destroy()
        else
            -- 簡單錯誤處理，不清空輸入框
            textBox.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
            wait(0.3)
            textBox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        end
    end)
    
    -- 回車鍵提交
    textBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            verifyButton.MouseButton1Click:Fire()
        end
    end)
    
    -- 等待驗證完成
    while not done do
        wait()
    end
    
    return true
end

-- 主執行流程
local success = createAuthUI()

if success then
    -- 驗證成功，加載WindUI
    local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()

    WindUI:Localization({
        Enabled = true,
        Prefix = "loc:",
        DefaultLanguage = "en",
        Translations = {
            ["en"] = {
                ["WELCOME"] = "歡迎使用LOL漢化hub",
                ["LIB_DESC"] = "測試版",
            }
        }
    })

    WindUI.TransparencyValue = 0.2
    WindUI:SetTheme("Dark")

    local function gradient(text, startColor, endColor)
        local result = ""
        for i = 1, #text do
            local t = (i - 1) / (#text - 1)
            local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
            local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
            local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
            result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
        end
        return result
    end

    WindUI:Popup({
        Title = gradient("LOL漢化hub", Color3.fromHex("#6A11CB"), Color3.fromHex("#2575FC")),
        Icon = "sparkles",
        Content = "驗證成功！歡迎使用LOL漢化hub",
        Buttons = {
            {
                Title = "開始使用",
                Icon = "arrow-right",
                Variant = "Primary",
                Callback = function() end
            }
        }
    })

    -- 調整窗口大小為移動端友好尺寸
    local Window = WindUI:CreateWindow({
        Title = "LOL漢化hub",
        Icon = "palette",
        Author = "歡迎使用LOL漢化hub",
        Folder = "WindUI_Example",
        Size = UDim2.fromOffset(600, 700), -- 調整為更適合移動端的尺寸
        Theme = "Dark",
        User = {
            Enabled = true,
            Anonymous = true,
            Callback = function()
                WindUI:Notify({
                    Title = "用戶資料",
                    Content = "用戶資料點擊！",
                    Duration = 3
                })
            end
        },
        SideBarWidth = 180, -- 稍微減小側邊欄寬度以適應移動端
        ScrollBarEnabled = true
    })

    Window:Tag({
        Title = "0.0.1",
        Color = Color3.fromHex("#30ff6a")
    })
    Window:Tag({
        Title = "BETA",
    })

    Window:CreateTopbarButton("theme-switcher", "moon", function()
        WindUI:SetTheme(WindUI:GetCurrentTheme() == "Dark" and "Light" or "Dark")
        WindUI:Notify({
            Title = "主題已更改",
            Content = "當前主題: "..WindUI:GetCurrentTheme(),
            Duration = 2
        })
    end, 990)

    -- 創建腳本標籤頁
    local ScriptsSection = Window:Section({ Title = "腳本", Opened = true })
    local ScriptsTab = ScriptsSection:Tab({ Title = "腳本", Icon = "code" })

    -- 添加Fartsaken按鈕
    ScriptsTab:Button({
        Title = "Fartsaken被遺棄",
        Icon = "play",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/useert741/-X---byLOL/refs/heads/main/Fartsaken-LOL-QQ737561425"))()
        end
    })

    -- 添加BronxWare 99 Nights漢化按鈕
    ScriptsTab:Button({
        Title = "BronxWare 99 Nights漢化",
        Icon = "play",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/useert741/-X---byLOL/refs/heads/main/BronxWare99Nights-LOL"))()
        end
    })

    -- 添加Doors XA Hub按鈕
    ScriptsTab:Button({
        Title = "Doors XA Hub",
        Icon = "play",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/useert741/-X---byLOL/refs/heads/main/DoorsXAHubLOL"))()
        end
    })

    -- 添加住宅大屠殺按鈕
    ScriptsTab:Button({
        Title = "住宅大屠殺",
        Icon = "play",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/useert741/-X---byLOL/refs/heads/main/LOLHANHUA"))()
        end
    })

    -- 添加Red Hub(死亡之死LOL漢化)按鈕
    ScriptsTab:Button({
        Title = "Red Hub(死亡之死LOL漢化)",
        Icon = "play",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/useert741/-X---byLOL/refs/heads/main/Death%20is%20die"))()
        end
    })

    -- 添加UNDETECTEDWARE犯罪(半漢化)按鈕
    ScriptsTab:Button({
        Title = "UNDETECTEDWARE犯罪(半漢化)",
        Icon = "play",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/useert741/-X---byLOL/refs/heads/main/UNDETECTEDWARE-LOLHAZNHUA"))()
        end
    })

    Window:OnClose(function()
        print("Window closed")
    end)

    Window:OnDestroy(function()
        print("Window destroyed")
    end)
end
